<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>æˆ‘çš„è®¡åˆ’</title>
    <style>
        /* --- åŸºç¡€æ ·å¼ --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #ededed; /* å¾®ä¿¡ç»å…¸ç°åº• */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* --- èŠå¤©åŒºåŸŸ --- */
        #chat-container {
            flex: 1;
            padding: 20px 15px;
            overflow-y: auto; /* å…è®¸æ»šåŠ¨ */
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding-bottom: 80px; /* é˜²æ­¢è¢«åº•éƒ¨è¾“å…¥æ¡†é®æŒ¡ */
        }

        /* --- æ¶ˆæ¯æ°”æ³¡æ ·å¼ --- */
        .message-row {
            display: flex;
            justify-content: flex-end; /* éƒ½åœ¨å³è¾¹ï¼Œå› ä¸ºæ˜¯"æˆ‘"å‘çš„ */
            animation: fadeIn 0.3s ease;
        }

        .bubble {
            max-width: 80%;
            padding: 10px 14px;
            font-size: 16px;
            line-height: 1.5;
            border-radius: 8px;
            position: relative;
            word-wrap: break-word;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            transition: all 0.2s;
            cursor: pointer;
            user-select: none;
        }

        /* å¾…åŠçŠ¶æ€ï¼ˆç»¿è‰²æ°”æ³¡ï¼‰ */
        .todo {
            background-color: #95ec69; /* å¾®ä¿¡ç»¿ */
            color: #000;
        }
        .todo::after {
            /* å°ä¸‰è§’ */
            content: '';
            position: absolute;
            right: -6px;
            top: 10px;
            border-left: 6px solid #95ec69;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
        }

        /* å®ŒæˆçŠ¶æ€ï¼ˆç°è‰²æ°”æ³¡ï¼‰ */
        .done {
            background-color: #dcdcdc;
            color: #888;
            text-decoration: line-through;
        }
        .done::after {
            border-left-color: #dcdcdc;
        }

        /* æ—¶é—´æˆ³æ ·å¼ */
        .timestamp {
            text-align: center;
            font-size: 12px;
            color: #b2b2b2;
            margin-bottom: -5px;
            margin-top: 5px;
        }

        /* --- åº•éƒ¨è¾“å…¥æ  --- */
        .input-area {
            position: fixed;
            bottom: 0;
            width: 100%;
            background-color: #f7f7f7;
            border-top: 1px solid #dcdcdc;
            padding: 10px;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            padding-bottom: env(safe-area-inset-bottom); /* é€‚é…iPhoneåº•éƒ¨æ¨ªæ¡ */
        }

        input {
            flex: 1;
            height: 40px;
            border: none;
            border-radius: 6px;
            padding: 0 10px;
            font-size: 16px;
            background-color: #fff;
            margin-right: 10px;
        }
        input:focus {
            outline: none;
        }

        button {
            height: 40px;
            padding: 0 15px;
            background-color: #07c160;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: bold;
        }
        button:active {
            background-color: #06ad56;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <div id="chat-container">
        <div class="timestamp">ä»Šå¤©</div>
        <div class="message-row" style="justify-content: flex-start;">
            <div class="bubble" style="background-color: #fff; border-radius: 8px;">
                ğŸ‘‹ æ¬¢è¿ï¼è¿™æ˜¯ä½ çš„å•æœºç‰ˆè®¡åˆ’æ¸…å•ã€‚<br>
                - è¾“å…¥å†…å®¹ç‚¹å‡»å‘é€<br>
                - ç‚¹å‡»æ°”æ³¡æ ‡è®°å®Œæˆ<br>
                - åŒå‡»æ°”æ³¡åˆ é™¤
            </div>
        </div>
    </div>

    <div class="input-area">
        <input type="text" id="taskInput" placeholder="è¾“å…¥è®¡åˆ’..." autocomplete="off">
        <button onclick="addTask()">å‘é€</button>
    </div>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const taskInput = document.getElementById('taskInput');
        
        // 1. åŠ è½½æ•°æ®
        let tasks = JSON.parse(localStorage.getItem('myChatTasks')) || [];
        renderTasks();

        // 2. æ·»åŠ ä»»åŠ¡å‡½æ•°
        function addTask() {
            const text = taskInput.value.trim();
            if (!text) return;

            const newTask = {
                id: Date.now(),
                text: text,
                done: false,
                time: new Date().toLocaleTimeString('zh-CN', {hour: '2-digit', minute:'2-digit'})
            };

            tasks.push(newTask);
            saveAndRender();
            taskInput.value = '';
            scrollToBottom();
        }

        // 3. æ¸²æŸ“é¡µé¢ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
        function renderTasks() {
            // ä¿ç•™é‚£æ¡æ¬¢è¿æ¶ˆæ¯ï¼Œåªæ¸…é™¤åé¢çš„
            // å®é™…é¡¹ç›®ä¸­å¯ä»¥åšå¾—æ›´ä¸¥è°¨ï¼Œè¿™é‡Œä¸ºäº†ç®€å•ç›´æ¥é‡ç»˜
            const welcomeHtml = chatContainer.children[0].outerHTML + chatContainer.children[1].outerHTML; 
            
            // å¦‚æœæœ‰æ•°æ®ï¼Œæˆ‘ä»¬é‡æ–°ç”Ÿæˆåˆ—è¡¨ï¼›å¦‚æœæ²¡æ•°æ®ï¼Œä¿ç•™æ¬¢è¿è¯­
            if(tasks.length > 0) {
                 chatContainer.innerHTML = ''; // æ¸…ç©º
            } else {
                return; // ä¿æŒé»˜è®¤æ¬¢è¿è¯­
            }

            tasks.forEach(task => {
                const row = document.createElement('div');
                row.className = 'message-row';
                
                const bubble = document.createElement('div');
                bubble.className = `bubble ${task.done ? 'done' : 'todo'}`;
                bubble.innerText = task.text;
                
                // ç‚¹å‡»äº‹ä»¶ï¼šåˆ‡æ¢çŠ¶æ€
                bubble.onclick = () => {
                    task.done = !task.done;
                    saveAndRender();
                };

                // åŒå‡»äº‹ä»¶ï¼šåˆ é™¤
                bubble.ondblclick = () => {
                    if(confirm('åˆ é™¤è¿™æ¡è®¡åˆ’ï¼Ÿ')) {
                        tasks = tasks.filter(t => t.id !== task.id);
                        saveAndRender();
                    }
                };

                row.appendChild(bubble);
                chatContainer.appendChild(row);
            });
            
            scrollToBottom();
        }

        // 4. ä¿å­˜å¹¶åˆ·æ–°
        function saveAndRender() {
            localStorage.setItem('myChatTasks', JSON.stringify(tasks));
            renderTasks();
        }

        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // ç›‘å¬å›è½¦é”®
        taskInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                addTask();
            }
        });
    </script>
</body>
</html>